function getCurrentPage(){if($("#grid").data("kendoGrid")){var n=$("#grid").data("kendoGrid");return n.dataSource.page()}return 0}function findFile(n){for(var t=0;t<vmFile.CurrentListFile.length;t++)if(vmFile.CurrentListFile[t].Id==n)return vmFile.CurrentListFile[t];return null}function findFileAssign(n){for(var t=0;t<vmFile.contentFileAssigned.length;t++)if(vmFile.contentFileAssigned[t].Id==n)return vmFile.contentFileAssigned[t];return null}function showUploadFile(){vmFile.CurrentRole>0&&(vmFile.popUploadFile=showPopup(vmFile.popUploadFile,$("#popUploadFile"),vmCommon.rootUrl + "Contents/MsPopUploadFile.html",{height:530,width:620,resizable:!1}),vmFile.popUploadFile.title(kLg.titleUploadFile))}function showEditFile(n){var i=findFile(n),t,r;curPage=getCurrentPage();vmFile.FileEdit=i;t=i.Type;r={height:t==8?335:274,width:500,resizable:!1};vmFile.popEditFile=showPopup(vmFile.popEditFile,$("#popEditFile"),vmCommon.rootUrl + "Contents/MsPopEditFile.html",r);t>0?vmFile.popEditFile.title(t==8?kLg.editUrl:kLg.editFile):vmFile.popEditFile.title(kLg.editFolder)}function updateFile(n){if(vmFile.CurrentRole>0){var t=vmFile.CurrentRegion!=undefined?vmFile.CurrentRegion:0,i="../Handlers/DFolderHandler.ashx?funcName=updateFile&parentId="+vmFile.selectFolderId+"&projid="+projectId+"&strid="+strategyId+"&regid="+t;callAjax("file-loading",i,JSON.stringify(n),function(t){var i,r;if(n.Type!=0){for(i=0;i<vmFile.contentFileAssigned.length;i++)if(n.Id==vmFile.contentFileAssigned[i].Id){vmFile.contentFileAssigned[i].Name=n.Name;vmFile.contentFileAssigned[i].Description=n.Description;n.Type==8&&(vmFile.contentFileAssigned[i].PhysicalName=n.PhysicalName);break}for(r=0;r<vmFile.idFileAssigned.contents.length;r++)n.Id==vmFile.idFileAssigned.contents[r].Id&&(vmFile.idFileAssigned.contents[r].Name=n.Name,vmFile.idFileAssigned.contents[r].Description=n.Description)}(vmFile.popUpToAssign||vmFile.popUpFileManagement)&&bindGrid(t.Data,curPage);vmFile.popUpFileAssigned&&loadFileAssigned(vmFile.idFileAssigned.contents)},AjaxConst.PostRequest)}}function assignedFile(){function o(){if(vmCommon.checkCurrentPage(vmCommon.enumPage.ActionPlan)&&!vmGoalAction.checkOpenPopup&&(vmFile.idFileAssigned.assigntype==vmCommon.enumType.Goal||vmFile.idFileAssigned.assigntype==vmCommon.enumType.SubGoal||vmFile.idFileAssigned.assigntype==vmCommon.enumType.Action)){var n=MsaApp.componentService(MsaApp.IsShowNavigationMenu).get(vmFile.idFileAssigned.assignidu);n&&(item=n.item||n.goal,item.AssignFile=vmFile.idFileAssigned.fileids.length)}}var f,i,e,r;if(vmFile.RegionRole==undefined&&vmFile.CurrentRole<=0||vmFile.RegionRole<=0){vmFile.popUpFileAssigned&&vmFile.closePopUpFileAssign();vmFile.popUpToAssign&&vmFile.closePopUpToAssign();return}if(vmFile.idFileAssigned.assigntype===vmCommon.enumType.ActionTodoFile&&vmFile.idFileAssigned.func){vmFile.idFileAssigned.func(vmFile.idFileAssigned.contents);vmFile.defaultFileAssigned();vmFile.popUpFileAssigned&&vmFile.closePopUpFileAssign();vmFile.popUpToAssign&&vmFile.closePopUpToAssign();return}if(vmFile.defaultFileAssigned(),vmFile.idFileAssigned.assigntype===vmCommon.enumType.CrmStatusProtocol&&vmFile.idFileAssigned.assignidi<=0){var t=vmFile.idFileAssigned.contents,s=actViewModel.activity,u=s.CrmStatusProtocolClients,n=vmCommon.findById(vmFile.idFileAssigned.assignidi,u);if(n!=undefined&&(n.set("Files",t),n.set("StatusHasFileAssgined",t.length>0),t.length===0)){if(f=u.indexOf(n),i=$("#source-status tr:eq("+f+") td:last div:first span:first"),i.length===0)return;$(i).addClass("icon-folder-circle")}vmFile.popUpFileAssigned&&vmFile.closePopUpFileAssign();vmFile.popUpToAssign&&vmFile.closePopUpToAssign();return}e=vmFile.CurrentRegion!=undefined?vmFile.CurrentRegion:0;r="../Handlers/DFolderHandler.ashx?funcName=assignfile&projid="+projectId+"&strid="+strategyId+"&regid="+e;vmFile.RegionRole==undefined?vmFile.CurrentRole>0&&callAjax("file-loading",r,JSON.stringify(vmFile.idFileAssigned),function(){vmFile.afterAssign(vmFile.idFileAssigned);o();vmFile.popUpFileAssigned&&vmFile.closePopUpFileAssign();vmFile.popUpToAssign?vmFile.closePopUpToAssign():vmFile.closePopUpToAssign();vmFile.checkChangeIconFileCrm(vmFile.idFileAssigned.assignidi,vmFile.idFileAssigned.assigntype)},AjaxConst.PostRequest).finally(function(){document.getElementById("iconEmpty")&&vmFile.idFileAssigned.assigntype!==vmCommon.enumType.CrmStatusProtocol&&reloadAssignIcon(vmFile.idFileAssigned.contents.length>0)}):vmFile.RegionRole>0&&callAjax("file-loading",r,JSON.stringify(vmFile.idFileAssigned),function(){o();vmFile.popUpFileAssigned&&vmFile.closePopUpFileAssign();vmFile.popUpToAssign&&vmFile.closePopUpToAssign();vmFile.idFileAssigned.assigntype!==vmCommon.enumType.CrmStatusProtocol&&vmFile.idFileAssigned.assigntype!==vmCommon.enumType.Goal&&vmFile.idFileAssigned.assigntype!==vmCommon.enumType.SubGoal&&vmFile.idFileAssigned.assigntype!==vmCommon.enumType.Action&&getOldAssignedFile(vmFile.objAssign);vmFile.checkChangeIconFileCrm(vmFile.idFileAssigned.assignidi,vmFile.idFileAssigned.assigntype)},AjaxConst.PostRequest).finally(function(){document.getElementById("iconEmpty")?reloadAssignIcon(vmFile.idFileAssigned.contents.length>0):vmCommon.checkCurrentPage(vmCommon.enumPage.TeamBoard)&&vmCommon.Mediator.publish("RELOAD_BOARDLINE_COLUMN")});vmFile.vmObject&&(vmFile.vmObject.modelChanged=!0);vmFile.isFilterByImage=!1;vmFile.isSaveFromOtherSource=!1;vmFile.afterAssign(vmFile.idFileAssigned);currentStrategy.Type==="1"&&vmGoalAction&&vmGoalAction.checkOpenPopup&&(vmGoalAction.checkOpenPopup=!1,vmCommon.checkCurrentPage(vmCommon.enumPage.ActionPlan)&&(vmGoalAction.SubmarketIdFile&&MsaApp.loadOpenProducts(vmGoalAction.SubmarketIdFile),vmGoalAction.IndependenceIdFile&&MsaApp.loadOpenIndependencies(vmGoalAction.IndependenceIdFile),vmGoalAction.SubmarketIdFile=undefined,vmGoalAction.IndependenceIdFile=undefined))}function openFolderAssignFile(){var n=new queryString(!0),t=n.get("fa");t&&(vmFile.openPopUpFileAssign(),history.replaceState(null,document.title,removeURLParameter("fa")))}function showDeleteIcon(n){n.enableDeleteIcon!=!0||n.currentPopup==undefined||document.getElementById("iconDeleteCrm")||$("#"+vmFile.currentFormAction+"_wnd_title").next().prepend('<a role="button" href="javascript:vmFile.deleteCrm();" class="icon-open-file" style="padding:0px !important"><span id="iconDeleteCrm" role="presentation" class="icon-16 icon-file icon-delete-file" style="height:20px;width:20px;zoom:85%;"><\/span><\/a>')}function crmDeleteIsActive(){typeof vmEditAct!="undefined"&&(vmEditAct.isModified=!1);typeof vmEditOrg!="undefined"&&(vmEditOrg.isModified=!1);typeof vmEditPerson!="undefined"&&(vmEditPerson.isModified=!1)}function deleteCrm(){var n=vmFile.menuOptions.deleteData;pConfirm(kLg.confirmDeleteItem).then(function(){vmFile.dataservice.deleteCrm(n,deleteCrmCallback)})}function deleteCrmCallback(n){n.value==vmCrmEnum.ResultStatus.CONFLICT&&pAlert(kLg.msgConflictData);crmDeleteIsActive();vmFile.menuOptions.currentPopup.close();vmCrmFilterControl.reloadfilter(0,0)}function getOldAssignedFile(n,t){return new Promise(i=>{if(vmFile.enableAssignedIcon){vmFile.oldAssignedFile=[];var r=vmFile.CurrentRegion!=undefined?vmFile.CurrentRegion:0,u="../Handlers/DFolderHandler.ashx?funcName=getoldassignedfile&projid="+projectId+"&strid="+strategyId+"&regid="+r;callAjax("file-loading",u,JSON.stringify(n),function(n){var u,f,r;if(vmFile.oldAssignedFile=n.Data,vmFile.CurrentRole=n.Role,t)for(u=0;u<vmFile.oldAssignedFile.length;u++)f=vmFile.idFileAssigned.fileids.indexOf("cbx"+vmFile.oldAssignedFile[u].Id),f!==-1&&(vmFile.idFileAssigned.fileids.splice(f,1),vmFile.idFileAssigned.contents.splice(f,1));else vmFile.idFileAssigned.fileids=[],vmFile.idFileAssigned.contents=[],vmFile.contentFileAssigned=[];vmFile.oldAssignedFile&&(vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.oldAssignedFile,function(n){return"cbx"+n.Id}),vmCommon.pushApply(vmFile.idFileAssigned.contents,vmFile.oldAssignedFile),vmCommon.pushApply(vmFile.contentFileAssigned,vmFile.oldAssignedFile));r=vmFile.oldAssignedFile.length>0;document.getElementById("iconEmpty")&&reloadAssignIcon(r);vmFile.RegionRole==undefined?setIconFileAssign(r):vmFile.RegionRole>0?setIconFileAssign(r):vmFile.idFileAssigned.fileids.length>0&&setIconFileAssign(r);openFolderAssignFile();i()},AjaxConst.PostRequest)}})}function setIconFileAssign(n){document.getElementById("iconEmpty")||(typeof vmGoalAction=="object"&&vmGoalAction.SelectorId.action!=="vmGoalAction.showAddMainSubAction"||typeof vmGoalAction=="undefined")&&$("#"+vmFile.currentFormAction+"_wnd_title").next().prepend('<a role="button" href="javascript:vmFile.openFileAsignCrm('+(vmFile.idFileAssigned.assignidi?vmFile.idFileAssigned.assignidi:"'"+vmFile.idFileAssigned.assignidu+"'")+',"'+vmFile.idFileAssigned.assigntype+'");" class="icon-open-file" tabindex="2"><span id="iconEmpty" role="presentation" class="icon-16 icon-file"><\/span><\/a>');reloadAssignIcon(n)}function reloadAssignIcon(n){vmFile.idFileAssigned.assigntype!=vmCommon.enumType.ActionTodoFile&&(typeof vmGoalAction!="object"||vmGoalAction.SelectorId.action!=="vmGoalAction.showAddMainSubAction")&&(typeof vmGoalAction!="object"||vmGoalAction.SelectorId.action!=="vmGoalAction.showAddDetachedSubgoal")&&(n?($("#iconEmpty").removeClass("icon-folder-white").addClass("icon-folder-full-white"),$("#iconEmpty").css({width:"18px"}),$("#iconEmpty").parent().attr("href","javascript:vmFile.openFileAsignCrm("+(vmFile.idFileAssigned.assignidi?vmFile.idFileAssigned.assignidi:"'"+vmFile.idFileAssigned.assignidu+"'")+",'"+vmFile.idFileAssigned.assigntype+"');")):($("#iconEmpty").removeClass("icon-folder-full-white").addClass("icon-folder-white"),$("#iconEmpty").parent().attr("href","javascript:vmFile.openFileAsignCrm("+(vmFile.idFileAssigned.assignidi?vmFile.idFileAssigned.assignidi:"'"+vmFile.idFileAssigned.assignidu+"'")+",'"+vmFile.idFileAssigned.assigntype+"');")))}function showMenu(n,t,i,r,u,f){if(n>0){var e='<div class="ms-dropdow" style="float:left;cursor:pointer"><span class="icon-16 icon-dropdow-folder menulist-filemanager" data-toggle="dropdown"><\/span>';return e+='<ul aria-labelledby="btnGroupVerticalDrop1" class="popup-menu dropdown-menu ms-popup-menu posAbsolute" role="menu" style="left: -143px;">',vmFile.CurrentRole>0?(e+=f==null?'<li onclick="showEditFile('+n+')"><a class="dropdow-menu-li-a"><span class="icon-24  icon-left-block icon-command-gray"><\/span><span>'+kLg.btnRename+"<\/span><\/a><\/li>":'<li onclick="showEditFile('+n+')"><a class="dropdow-menu-li-a"><span class="icon-24  icon-left-block icon-command-gray"><\/span><span>'+kLg.btnRename+"<\/span><\/a><\/li>",u>0?(e+='<li role="presentation" class="divider"><\/li>',e+=u==8?'<li onclick=""><a href="'+htmlEscape(i)+'" target="_blank" class="dropdow-menu-li-a"><span class="icon-24 icon-left-block icon-update-gray"><\/span><span>'+kLg.btnDownload+"<\/span><\/a><\/li>":'<li onclick=""><a href="../FileUpload/'+htmlEscape(i)+'" target="_blank" download="'+r+'" class="dropdow-menu-li-a"><span class="icon-24 icon-left-block icon-update-gray"><\/span><span>'+kLg.btnDownload+"<\/span><\/a><\/li>"):e+='<li onclick=""><a class="dropdow-menu-li-a" onclick="vmFile.downloadFolder('+n+')"><span class="icon-24 icon-left-block icon-update-gray"><\/span><span>'+kLg.btnDownload+"<\/span><\/a><\/li>",e+='<li role="presentation" class="divider"><\/li>',e+='<li onclick=""><a href="javascript:deleteFileOverView('+n+", "+t+", "+u+');" class="dropdow-menu-li-a"><span class="icon-24  icon-left-block icon-delete"><\/span><span>'+kLg.btnDelete+"<\/span><\/a><\/li>",e+"<\/ul><\/div>"):u==0?(e+='<li onclick=""><a class="dropdow-menu-li-a" onclick="vmFile.downloadFolder('+n+')"><span class="icon-24 icon-left-block icon-update-gray"><\/span><span>'+kLg.btnDownload+"<\/span><\/a><\/li>",e+"<\/ul><\/div>"):(e+='<li onclick=""><a href="../FileUpload/'+htmlEscape(i)+'" target="_blank" download="'+r+'" class="dropdow-menu-li-a"><span class="icon-24 icon-left-block icon-update-gray"><\/span><span>'+kLg.btnDownload+"<\/span><\/a><\/li>",e+"<\/ul><\/div>")}return""}function showIcon(n,t,i,r){var u=setFileIcon(i);return i===7?"<div class='show-img'><span class=\"icon-20 icon-"+u+' td-icon" style="padding-left: 5px" fname="'+htmlEscape(r)+'" pname="'+htmlEscape(t)+'" ftype="'+i+'" ondblclick="downloadFile(this)"><\/span><img class="preview-img" src="../FileUpload/'+t+'" height="390"><\/div>':'<span class="icon-20 icon-'+u+' td-icon" style="padding-left: 5px" fname="'+htmlEscape(r)+'" pname="'+htmlEscape(t)+'" ftype="'+i+'" ondblclick="downloadFile(this)"><\/span>'}function showTime(n){return n==null?"":typeof n=="string"&&n.indexOf("Date")!==-1?kendo.toString(n.jsonToDate(),"d"):kendo.toString(new Date(n),"d")}function showDescription(n,t,i){var r=164;return t&&t.length>0?i==8?'<div style="width: '+r+'px"><a href="'+htmlEscape(n)+'" title="'+htmlEscape(t)+'" style="height: 20px;line-height:25px;font-family:Lato !important;text-decoration: underline;" class="file-sub" target="_blank">'+htmlEscape(t)+"<\/a><\/div>":'<div style="width: '+r+'px"><span title="'+htmlEscape(t)+'" style="height: 20px;line-height:25px;font-family:Lato !important;" class="file-sub">'+htmlEscape(t)+"<\/span><\/div>":i==8?'<div style="width: '+r+'px"><a href="'+htmlEscape(n)+'" title="'+htmlEscape(n)+'" style="height: 20px;line-height:25px;font-family:Lato !important;text-decoration: underline;" class="file-sub" target="_blank">'+htmlEscape(n)+"<\/a><\/div>":""}function showCreator(n){var t=undefined;return'<div style="width: 153px"><span title="'+n+'" class="file-sub" style="height: 20px;line-height:25px">'+htmlEscape(n)+"<\/span><\/div>"}function showName(n,t,i,r){return i==0?vmFile.CurrentRole>0?'<div id="'+n+'" type="'+i+'" class="dirType" style="width: 240px"><a href="javascript:openFolder('+n+');" tabindex="1"><span class="value-folder file-sub" title="'+htmlEscape(t)+'" style="height: 20px;line-height:25px" fname="'+htmlEscape(t)+'" pname="'+htmlEscape(r)+'" ftype="'+i+'" ondblclick="downloadFile(this)">'+htmlEscape(t)+"<\/span><\/a><\/div>":'<div id="'+n+'" type="'+i+'" style="width: 240px"><a href="javascript:openFolder('+n+');" tabindex="1"><span class="value-folder file-sub" title="'+htmlEscape(t)+'" style="height: 20px;line-height:25px" fname="'+htmlEscape(t)+'" pname="'+htmlEscape(r)+'" ftype="'+i+'" ondblclick="downloadFile(this)">'+htmlEscape(t)+"<\/span><\/a><\/div>":vmFile.CurrentRole>0?'<div id="'+n+'" type="'+i+'" class="dirType" style="width: 240px"><span title="'+htmlEscape(t)+'" class="file-sub" style="height: 20px;line-height:25px" fname="'+htmlEscape(t)+'" pname="'+htmlEscape(r)+'" ftype="'+i+'"  ondblclick="downloadFile(this)" onclick="copyTitleToClipboard(this)">'+htmlEscape(t)+"<\/span><\/div>":'<div id="'+n+'" type="'+i+'" style="width: 240px"><span title="'+htmlEscape(t)+'"  class="file-sub" style="height: 20px;line-height:25px" fname="'+htmlEscape(t)+'" pname="'+htmlEscape(r)+'" ftype="'+i+'" ondblclick="downloadFile(this)" onclick="copyTitleToClipboard(this)">'+htmlEscape(t)+"<\/span><\/div>"}function copyTitleToClipboard(n){isDblClick=!1;var t=$(n).prop("title");vmCommon.coppyToClipboard(t);setTimeout(function(){if(!isDblClick){var t=$(n).kendoTooltip({filter:"span",content:kLg.msgCopied,position:"top",animation:{open:{effects:"zoom",duration:69}}}).data("kendoTooltip");t.show($(n));setTimeout(function(){t.hide()},999);$(n).mouseleave(function(){t.hide();t.destroy()})}},234)}function downloadFile(n){isDblClick=!0;var t=$(n).attr("fname"),i=$(n).attr("pname");downloadFileName(t,i,"../FileUpload/")}function downloadFileName(n,t,i){if(t!=""){var r=document.createElement("a");r.download=n;r.href=i+t;document.body.appendChild(r);r.click();document.body.removeChild(r);delete r}}function setupDragDrop(){function n(){$("body").css("cursor","auto");vmCommon.HandleDragDrop=undefined}$(".fileDraggable").draggable({axis:"y",cursor:"move",helper:"clone",handle:"div.dirType",handler:"icon-arow-towway-transverse-w",scroll:!0,start:function(n,t){var i,r,u;vmCommon.HandleDragDrop={};i=t.helper;i.addClass("onFileDragging");r=t.offset;vmCommon.HandleDragDrop.yDrag=r.top;i=i.find(".dirType");vmCommon.HandleDragDrop.sourceId=parseInt(i.attr("id"));u=i.closest("td");vmCommon.HandleDragDrop.parentSourceId=parseInt(u.attr("parentId"))},stop:function(n,t){t.helper.removeClass("onFileDragging")}});$(".fileDroppable").droppable({hoverClass:"ui-state-hover",accept:".fileDroppable",tolerance:"pointer",drop:function(){var t=parseInt($(this).find(".dirType").attr("id")),i;vmCommon.HandleDragDrop.sourceId!=t&&(i=vmCommon.getPosUpByY($(this).offset(),vmCommon.HandleDragDrop.yDrag),changePosition(t,vmCommon.HandleDragDrop.sourceId,i),n())}});$(".folderDroppable").droppable({hoverClass:"ui-state-hover",tolerance:"pointer",drop:function(t,i){var f=$(this).find(".dirType"),r=parseInt(f.attr("id")),u;vmCommon.HandleDragDrop.sourceId!=r&&(i.helper.find(".dirType").attr("type")>0?moveFileToFolder(vmCommon.HandleDragDrop.sourceId,r):(u=vmCommon.getPosUpByY($(this).offset(),vmCommon.HandleDragDrop.yDrag),changePosition(r,vmCommon.HandleDragDrop.sourceId,u)),n())}})}function changePosition(n,t,i){var r="../Handlers/DFolderHandler.ashx?funcName=changeposition&projid="+projectId+"&parentId="+vmFile.selectFolderId+"&strid="+strategyId,u=findFile(n),f=findFile(t),e={DesId:n,SourceId:t,Position:i,DesMdf:u.Mdf,SourceMdf:f.Mdf};callAjax("file-loading",r,JSON.stringify(e),function(n){bindGrid(n.Data,currentPage)},AjaxConst.PostRequest)}function moveFileToFolder(n,t){var i="../Handlers/DFolderHandler.ashx?funcName=movefile&projid="+projectId+"&parentId="+vmFile.selectFolderId+"&strid="+strategyId,r={DesId:t,SourceId:n};callAjax("file-loading",i,JSON.stringify(r),function(n){bindGrid(n.Data,currentPage)},AjaxConst.PostRequest)}function overloadFilesAlert(){pAlert(kLg.msgFileOverLoad)}function maxLengthFilesAlert(){pAlert(kLg.msgFileMaxLength)}function validFileUpload(n){for(var t=0;t<n.length;t++)if(n[t].size>104857600)return overloadFilesAlert(),!1;return!0}function dwp(n){$("button","#"+n).attr("disabled","disabled")}function overMaxLength(n){var r=n.length,i,t;if(r<2)return!1;for(i=0,t=0,t;t<r;t++)i+=n[t].size;return i>524288e3}function UploadFunc(n,t,i){return this.upFile=n,this.upUrl=t,this.upPath=i,this}var vmFile=vmFile||{},curPage,isDblClick,currentPage;vmFile.objAssign={folderfileid:0,assignidi:undefined,assignidu:undefined,type:undefined};vmFile.popEditFile=null;vmFile.popUploadFile=null;vmFile.FileEdit=undefined;vmFile.isAssigned=!1;vmFile.idFileAssigned={fileids:[],assignidi:undefined,assignidu:undefined,assigntype:undefined,contents:[]};vmFile.contentFileAssigned=[];vmFile.enableAssignedIcon=!1;vmFile.oldAssignedFile=undefined;vmFile.popUpFileAssigned=null;vmFile.popUpToAssign=undefined;vmFile.popUpFileManagement=undefined;vmFile.isChangeData=!1;vmFile.CurrentListFile=[];vmFile.currentFormAction=undefined;vmFile.treeLists=undefined;vmFile.selectFolderId=0;vmFile.isUploading=!1;vmFile.isShowEditFile={isShowEdit:!1,fileId:undefined};vmFile.XHRObj=null;vmFile.CurrentRole=undefined;vmFile.RegionRole=undefined;vmFile.menuOptions={};vmFile.isSaveFromOtherSource=!0;vmFile.isFilterByImage=!1;vmFile.popFileAssignedActive=!1;vmFile.popFileAssignedOpen=!1;curPage=1;vmFile.openPopUpFileManagement=function(n){vmFile.popFileAssignedOpen=!1;vmFile.elementid=n;vmFile.isAssigned=!1;vmFile.selectFolderId=0;vmFile.treeLists=[{fid:vmFile.selectFolderId,fname:kLg.titleDocument}];vmFile.popUpFileManagement=showPopup(vmFile.popUpFileManagement,$("#pop-file-management-place"),vmCommon.rootUrl + "Contents/MsPopFileManagement.html",{title:kLg.lblTitleFileManager,height:820,width:860,resizable:!1})};vmFile.popAddPerson=undefined;vmFile.openPopAddPerson=function(){vmFile.popAddPerson=showPopup(vmFile.popAddPerson,$("#pop-register"),vmCommon.rootUrl + "Contents/popAddPerson.html",{title:"Register",height:345,width:720,resizable:!1}).center()};vmFile.openPopUpFileManagementHistory=function(n,t){if(vmFile.popFileAssignedOpen=!1,vmFile.isAssigned=!1,vmFile.treeLists=[{fid:vmFile.selectFolderId,fname:kLg.titleDocument}],vmFile.selectFolderId=0,vmFile.isShowEditFile={isShowEdit:t,fileId:n},n!=undefined){var i="../Handlers/DFolderHandler.ashx?funcName=gettree&projid="+projectId+"&fileId="+n+"&strid="+strategyId;callAjax("file-loading",i,null,function(n){for(var r,i=n.value,t=1;t<i.length-1;t++)r={fid:i[t].Id,fname:i[t].Name},vmFile.treeLists.push(r),t==i.length-2&&(vmFile.selectFolderId=i[t].Id);vmFile.isAssigned=!1;vmFile.popUpFileManagement=showPopup(vmFile.popUpFileManagement,$("#pop-file-management-place"),vmCommon.rootUrl + "Contents/MsPopFileManagement.html",{title:kLg.lblTitleFileManager,height:820,width:860,resizable:!1})},AjaxConst.PostRequest)}};vmFile.callFromActivities=!1;vmFile.openPopUpToAssign=function(n){vmFile.popFileAssignedOpen=typeof n!="undefined"?!0:!1;vmFile.callFromActivities=!0;vmFile.isAssigned=!0;vmFile.selectFolderId=0;vmFile.treeLists=[{fid:vmFile.selectFolderId,fname:kLg.titleDocument}];vmFile.popUpToAssign=showPopup(vmFile.popUpToAssign,$("#pop-file-management-place"),vmCommon.rootUrl + "Contents/MsPopFileManagement.html",{title:kLg.lblTitleFileManager,height:820,width:860,resizable:!1})};vmFile.closePopUpToAssign=function(){vmFile.selectFolderId=0;vmFile.treeLists=undefined;vmFile.popUpToAssign&&vmFile.popUpToAssign.close()};vmFile.openPopUpFileAssign=function(){vmFile.callFromActivities=!1;vmFile.popUpFileAssigned=showPopup(vmFile.popUpFileAssigned,$("#pop-file-assigned"),vmCommon.rootUrl + "Contents/MsPopFileAssigned.html",{title:kLg.titleFileAssigned,height:800,width:860,resizable:!1})};vmFile.closePopUpFileAssign=function(){vmFile.popUpFileAssigned.close()};vmFile.isSwitchPopUp=!1;vmFile.switchPopUpFileAssign=function(n){vmFile.isSwitchPopUp=!0;typeof n!="undefined"?vmFile.openPopUpToAssign("openassign"):vmFile.openPopUpToAssign();vmFile.popUpFileAssigned.close();vmFile.idFileAssigned.assigntype===vmCommon.enumType.CrmLinkAnswer&&(vmFile.isFilterByImage=!0)};vmFile.afterAssign=function(n){var r,i,t,u;if(vmFile.optionResult!=undefined){switch(vmFile.optionResult.ForAction){case vmCommon.enumType.CrmLinkAnswer:r=$("#"+vmFile.optionResult.ElmId).parent();$(r).find("img").parent().remove();n.contents.length>0&&n.contents[0].Type===7&&(i=n.contents[0].PhysicalName,t=n.contents[0].ImageSize,i&&(t!==null&&t!==undefined&&t!==""?$(r).append('<div class="preview-img divImage"><img src="../FileUpload/'+i+'" height="90" width="150" class="imageShow"><span class="spanShow">'+t+"<\/span><\/div>"):$(r).append('<img class="preview-img" src="../FileUpload/'+i+'" height="390">')),u=vmQuestionView.getAnswerFromThema(vmFile.optionResult.Id,vmFile.optionResult.ThemaId),u.ImagePath=i,u.ImageSize=t)}vmFile.optionResult=undefined}};vmFile.afterDelete=function(n){var i,t,r,u;if(n.length!==0)switch(getCurrentPageName()){case"CrmQuestionAnswer":for(i=0;i<n.length;i++)(t=n[i],t.length!==0)&&(r=t.substring(0,t.indexOf(".")),u=t.substring(r.length),$("img[class='imageShow'][src='../FileUpload/"+r+u.toLowerCase()+"']").closest("div.preview-img").remove(),$("img[class='imageShow'][src='../FileUpload/"+r+u.toUpperCase()+"']").closest("div.preview-img").remove());break;default:return}};vmFile.setAssignedI=function(n,t,i){vmFile.RegionRole=i;vmFile.objAssign={folderfileid:0,assignidi:undefined,assignidu:undefined,type:undefined};vmFile.objAssign.assignidi=n;vmFile.objAssign.type=t;vmFile.enableAssignedIcon=!0;vmFile.idFileAssigned.assigntype=t;vmFile.idFileAssigned.assignidi=n;vmFile.idFileAssigned.assignidu=null};vmFile.setAssignedU=function(n,t,i){vmFile.RegionRole=i;vmFile.objAssign={folderfileid:0,assignidi:undefined,assignidu:undefined,type:undefined};vmFile.objAssign.assignidu=n;vmFile.objAssign.type=t;vmFile.enableAssignedIcon=!0;vmFile.idFileAssigned.assigntype=t;vmFile.idFileAssigned.assignidu=n;vmFile.idFileAssigned.assignidi=null};vmFile.setOffMenuIcon=function(){vmFile.enableAssignedIcon=!1;vmFile.menuOptions={enableDeleteIcon:!1}};vmFile.setDeleteIcon=function(n){vmFile.menuOptions.enableDeleteIcon||(vmFile.menuOptions.enableDeleteIcon=!0,vmFile.menuOptions.deleteData=n)};vmFile.assginedIcon=function(n,t){return new Promise(i=>{vmFile.menuOptions.currentPopup=t,vmFile.enableAssignedIcon&&(vmFile.currentFormAction=n,(vmFile.objAssign.assignidi!=undefined||vmFile.objAssign.assignidu!=undefined)&&getOldAssignedFile(vmFile.objAssign).then(function(){i()})),vmFile.menuOptions.enableDeleteIcon&&showDeleteIcon(vmFile.menuOptions)})};vmFile.deleteCrm=function(){vmFile.menuOptions.deleteData.type==vmCrmEnum.SettingType.Organisation?vmFile.dataservice.checkEnableDeleteCrm({id:vmFile.menuOptions.deleteData.id},function(n){n.value?deleteCrm():pAlert(kLg.msgOrganisationIsUsed)}):deleteCrm()};vmFile.openFileAsignNonIcon=function(n,t,i){vmFile.popFileAssignedOpen=!1;vmFile.elementid=n;vmFile.idFileAssigned.assigntype=t;vmFile.idFileAssigned.assignidi=n;vmFile.idFileAssigned.assignidu=null;vmFile.idFileAssigned.otherId=i;var r="../Handlers/DFolderHandler.ashx?funcName=getoldassignedfile&projid="+projectId+"&strid="+strategyId+"&fid="+i;callAjax("file-loading",r,JSON.stringify({assignidi:n,type:t}),function(n){vmFile.oldAssignedFile=n.Data;vmFile.CurrentRole=n.Role;vmFile.RegionRole=undefined;vmFile.idFileAssigned.fileids=[];vmFile.idFileAssigned.contents=[];vmFile.contentFileAssigned=[];vmFile.oldAssignedFile&&(vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.oldAssignedFile,function(n){return"cbx"+n.Id}),vmCommon.pushApply(vmFile.idFileAssigned.contents,vmFile.oldAssignedFile),vmCommon.pushApply(vmFile.contentFileAssigned,vmFile.oldAssignedFile),vmFile.oldAssignedFile.length>0||vmFile.CurrentRole==vmCommon.MemberRole.View?vmFile.openPopUpFileAssign():vmFile.openPopUpToAssign())},AjaxConst.PostRequest)};vmFile.openFileAsignCrm=function(n,t,i){var u,r,f;if(vmFile.oldAssignedFile=[],vmFile.contentFileAssigned=[],vmFile.idFileAssigned.fileids=[],vmFile.idFileAssigned.assigntype=t,vmFile.idFileAssigned.assignidi=isNaN(Number(n))?null:n,vmFile.idFileAssigned.assignidu=isNaN(Number(n))?n:null,vmFile.idFileAssigned.otherId=0,vmFile.idFileAssigned.CrmElement=i,t==vmCommon.enumType.Action&&typeof vmEditAction!="undefined"&&vmEditAction.backupParentFile!=null&&(vmFile.idFileAssigned=vmCommon.deepCopy(vmEditAction.backupParentFile),vmEditAction.backupParentFile=null),vmFile.idFileAssigned.assigntype===vmCommon.enumType.CrmStatusProtocol&&vmFile.idFileAssigned.assignidi<0){u=actViewModel.activity.CrmStatusProtocolClients;r=vmCommon.findById(vmFile.idFileAssigned.assignidi,u);r!=undefined&&(vmFile.idFileAssigned.contents=vmCommon.deepCopy(r.Files||[]),vmFile.oldAssignedFile=vmCommon.deepCopy(r.Files||[]),vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.oldAssignedFile,function(n){return"cbx"+n.Id}),vmCommon.pushApply(vmFile.contentFileAssigned,vmFile.oldAssignedFile),vmFile.oldAssignedFile.length>0?vmFile.openPopUpFileAssign():vmFile.openPopUpToAssign("openassign"));return}f="../Handlers/DFolderHandler.ashx?funcName=getoldassignedfile&projid="+projectId+"&strid="+strategyId;callAjax("file-loading",f,JSON.stringify({assignidi:vmFile.idFileAssigned.assignidi,assignidu:vmFile.idFileAssigned.assignidu,type:t}),function(n){vmFile.oldAssignedFile=n.Data;vmFile.CurrentRole=n.Role;vmFile.idFileAssigned.fileids=[];vmFile.idFileAssigned.contents=[];vmFile.contentFileAssigned=[];vmFile.oldAssignedFile&&(vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.oldAssignedFile,function(n){return"cbx"+n.Id}),vmCommon.pushApply(vmFile.idFileAssigned.contents,vmFile.oldAssignedFile),vmCommon.pushApply(vmFile.contentFileAssigned,vmFile.oldAssignedFile),vmFile.oldAssignedFile.length>0?vmFile.openPopUpFileAssign():vmFile.openPopUpToAssign("openassign"))},AjaxConst.PostRequest)};vmFile.reLoadFileAssigned=function(n){if(vmFile.enableAssignedIcon){vmFile.oldAssignedFile=[];var t=vmFile.CurrentRegion!=undefined?vmFile.CurrentRegion:0,i="../Handlers/DFolderHandler.ashx?funcName=getoldassignedfile&projid="+projectId+"&strid="+strategyId+"&regid="+t;callAjax("file-loading",i,JSON.stringify(vmFile.objAssign),function(t){var r,u,i;if(vmFile.oldAssignedFile=t.Data,vmFile.CurrentRole=t.Role,n)for(r=0;r<vmFile.oldAssignedFile.length;r++)u=vmFile.idFileAssigned.fileids.indexOf("cbx"+vmFile.oldAssignedFile[r].Id),u!==-1&&(vmFile.idFileAssigned.fileids.splice(u,1),vmFile.idFileAssigned.contents.splice(u,1));else vmFile.idFileAssigned.fileids=[],vmFile.idFileAssigned.contents=[],vmFile.contentFileAssigned=[];vmFile.oldAssignedFile&&(vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.oldAssignedFile,function(n){return"cbx"+n.Id}),vmCommon.pushApply(vmFile.idFileAssigned.contents,vmFile.oldAssignedFile),vmCommon.pushApply(vmFile.contentFileAssigned,vmFile.oldAssignedFile));i=vmFile.oldAssignedFile.length>0;document.getElementById("iconEmpty")&&reloadAssignIcon(i);vmFile.RegionRole==undefined?setIconFileAssign(i):vmFile.RegionRole>0?setIconFileAssign(i):vmFile.idFileAssigned.fileids.length>0&&setIconFileAssign(i);openFolderAssignFile()},AjaxConst.PostRequest)}};vmFile.reLoadFileAssignedByDragDrop=function(n){vmFile.oldAssignedFile=[];var t=vmFile.CurrentRegion!=undefined?vmFile.CurrentRegion:0,i="../Handlers/DFolderHandler.ashx?funcName=getoldassignedfile&projid="+projectId+"&strid="+strategyId+"&regid="+t;vmFile.objAssign={folderfileid:0,assignidi:vmFile.idFileAssigned.assignidi,assignidu:undefined,type:vmFile.idFileAssigned.assigntype};callAjax("file-loading",i,JSON.stringify(vmFile.objAssign),function(t){for(var u,r,i=0;i<t.Data.length;i++){for(u=!0,r=0;r<vmFile.idFileAssigned.fileids.length;r++)if("cbx"+t.Data[i].Id===vmFile.idFileAssigned.fileids[r]){u=!1;break}u&&(vmFile.idFileAssigned.fileids.push("cbx"+t.Data[i].Id),vmFile.idFileAssigned.contents.push(t.Data[i]),vmFile.contentFileAssigned.push(t.Data[i]))}typeof n=="function"?n(vmFile.idFileAssigned.contents):typeof loadFileAssigned=="function"&&loadFileAssigned(vmFile.idFileAssigned.contents)},AjaxConst.PostRequest)};vmFile.setFileFromOtherSource=function(n,t){var r,u,i;if(vmFile.oldAssignedFile=[],vmFile.oldAssignedFile=n,t)for(r=0;r<vmFile.oldAssignedFile.length;r++)u=vmFile.idFileAssigned.fileids.indexOf("cbx"+vmFile.oldAssignedFile[r].Id),u!==-1&&(vmFile.idFileAssigned.fileids.splice(u,1),vmFile.idFileAssigned.contents.splice(u,1));else vmFile.idFileAssigned.fileids=[],vmFile.idFileAssigned.contents=[],vmFile.contentFileAssigned=[];vmFile.oldAssignedFile&&(vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.oldAssignedFile,function(n){return"cbx"+n.Id}),vmCommon.pushApply(vmFile.idFileAssigned.contents,vmFile.oldAssignedFile),vmCommon.pushApply(vmFile.contentFileAssigned,vmFile.oldAssignedFile));i=vmFile.oldAssignedFile.length>0;document.getElementById("iconEmpty")&&reloadAssignIcon(i);vmFile.RegionRole==undefined?setIconFileAssign(i):vmFile.RegionRole>0?setIconFileAssign(i):vmFile.idFileAssigned.fileids.length>0&&setIconFileAssign(i)};vmFile.downloadFolder=function(n){callAjax("file-loading","../Handlers/DFolderHandler.ashx?funcName=downloadfolder",JSON.stringify({id:n}),function(n){var i=n.value,t=i.TheObject;i.ResultStatus===1&&t?vmCommon.GetFileFromUrl(t.Path,t.Name):pAlert("Error!")},AjaxConst.PostRequest)};currentPage=undefined;vmFile.DeleteFile=function(n,t){var i,r,u;vmFile.CurrentRole>0&&(i={id:n,mdf:t},currentPage=getCurrentPage(),r=vmFile.CurrentRegion!=undefined?vmFile.CurrentRegion:0,u="../Handlers/DFolderHandler.ashx?funcName=deletefile&parentId="+vmFile.selectFolderId+"&projid="+projectId+"&strid="+strategyId+"&regid="+r,callAjax("file-loading",u,JSON.stringify(i),function(n){vmFile.popUpFileManagement&&bindGrid(n.Data,currentPage);(vmFile.popUpToAssign||vmFile.popUpFileAssigned)&&(vmFile.popUpToAssign&&bindGrid(n.Data,currentPage),vmFile.popUpFileAssigned&&loadFileAssigned(vmFile.idFileAssigned.contents),getOldAssignedFile(vmFile.objAssign,!0),vmFile.checkChangeIconFileCrm(vmFile.idFileAssigned.assignidi,vmFile.idFileAssigned.assigntype));vmFile.vmObject&&(vmFile.vmObject.modelChanged=!0);window.location.pathname.indexOf("MsGoalAction")!==-1&&(vmGoalAction.SubmarketIdFile&&MsaApp.loadOpenProducts(vmGoalAction.SubmarketIdFile),vmGoalAction.IndependenceIdFile&&MsaApp.loadOpenIndependencies(vmGoalAction.IndependenceIdFile),MsaApp.NavigationMenuView.length&&MsaApp.reloadDataContentRightView());vmFile.reloadPageFileIcon();vmFile.openTodoFileAssign&&vmFile.openTodoFileAssign(vmFile.idFileAssigned)},AjaxConst.PostRequest))};vmFile.dataservice=function(){var n="../Handlers/DFolderHandler.ashx?funcName=",r=function(t,i,r,u,f){var e=n+i+"&projid="+projectId+"&strid="+strategyId;return callAjax(t,e,r,f,u)},t=function(t,i){var r=n+t+"&projid="+projectId+"&strid="+strategyId;return callAjaxPromise(r,i)},i=function(n,t,i){return r("person-loading",n,JSON.stringify(t),AjaxConst.PostRequest,i)},u=function(n,t){i("deletecrm",n,t)},f=function(n,t){i("checkenabledelete",n,t)},e=function(n){return t("checkCanDeleteAssignedFile",n)},o=function(n){return t("deleteMultifile",n)};return{deleteCrm:u,checkEnableDeleteCrm:f,checkEnableDeleteFileMarketing:e,deleteMultiFileMarketing:o}}();vmFile.checkChangeIconFileCrm=function(n,t){if(n&&(!n||!(n<=0))&&(t==vmCommon.enumType.CrmThema||t==vmCommon.enumType.CrmOrganisation||t==vmCommon.enumType.CrmPerson||t==vmCommon.enumType.CrmActivity||t==vmCommon.enumType.CrmStatusProtocol)){var i="../Handlers/DFolderHandler.ashx?funcName=getoldassignedfile&projid="+projectId+"&strid="+strategyId;callAjax("loading-question",i,JSON.stringify({assignidi:n,type:t}),function(i){var e,u;vmFile.oldAssignedFile=i.Data;switch(t){case vmCommon.enumType.CrmThema:vmFile.setIconFileThema(vmFile.oldAssignedFile,n);break;case vmCommon.enumType.CrmOrganisation:if(!vmFile.checkCurrentPage(vmCrmEnum.SettingType.Organisation))return;vmFile.setIconFileCrm(vmFile.oldAssignedFile);break;case vmCommon.enumType.CrmPerson:if(!vmFile.checkCurrentPage(vmCrmEnum.SettingType.Person))return;vmFile.setIconFileCrm(vmFile.oldAssignedFile);break;case vmCommon.enumType.CrmActivity:if(!vmFile.checkCurrentPage(vmCrmEnum.SettingType.Activities))return;vmFile.setIconFileCrm(vmFile.oldAssignedFile);break;case vmCommon.enumType.CrmStatusProtocol:var o=actViewModel.activity,f=o.CrmStatusProtocolClients,r=vmCommon.findById(vmFile.idFileAssigned.assignidi,f);if(!r)return;if(e=f.indexOf(r),r.set("StatusHasFileAssgined",vmFile.oldAssignedFile.length>0),vmFile.oldAssignedFile.length===0){if(u=$("#source-status table tr:eq("+e+") td[type=file] span:first"),u.length===0)return;$(u).addClass("icon-folder-circle")}isReloadForm=!0}},AjaxConst.PostRequest)}};vmFile.checkCurrentPage=function(n){return vmCrmFilterControl.flagPage===n};vmFile.setIconFileThema=function(n,t){if(n){var i=vmQuestionView.ultilities.findThemaById(t);n.length>0?(i.isFileAssigned=!0,$("#spaniconfileAssigned"+vmFile.idFileAssigned.assignidi).removeClass("icon-folder-thema").addClass("icon-folder-thema-fileAssigned")):(i.isFileAssigned=!1,$("#spaniconfileAssigned"+vmFile.idFileAssigned.assignidi).removeClass("icon-folder-thema-fileAssigned").addClass("icon-folder-thema"))}};vmFile.setIconFileCrm=function(n){n&&(n.length>0?$("#iconCrmFileAssignId").removeClass("icon-folder-organ").addClass("icon-file-assign-crm"):$("#iconCrmFileAssignId").removeClass("icon-file-assign-crm").addClass("icon-folder-organ"))};vmFile.isChangeFileAssigned=!1;vmFile.tempAssignedFile={fileids:[],contents:[]};vmFile.backupFileAssigned=function(){vmFile.isChangeFileAssigned||(vmFile.isChangeFileAssigned=!0,vmFile.tempAssignedFile={fileids:[],contents:[]},vmCommon.pushApply(vmFile.tempAssignedFile.fileids,vmFile.idFileAssigned.fileids),vmCommon.pushApply(vmFile.tempAssignedFile.contents,vmFile.idFileAssigned.contents),vmFile.idFileAssigned.assigntype!=vmCommon.enumType.CrmStatusProtocol&&reloadAssignIcon(vmFile.idFileAssigned.fileids.length>0))};vmFile.restoreFileAssigned=function(){var n,t;if(vmFile.idFileAssigned.fileids=[],vmFile.idFileAssigned.contents=[],vmCommon.pushApply(vmFile.idFileAssigned.fileids,vmFile.tempAssignedFile.fileids),vmCommon.pushApply(vmFile.idFileAssigned.contents,vmFile.tempAssignedFile.contents),vmFile.isChangeFileAssigned=!1,vmFile.tempAssignedFile={fileids:[],contents:[]},vmFile.idFileAssigned.assigntype!==vmCommon.enumType.CrmStatusProtocol&&reloadAssignIcon(vmFile.idFileAssigned.fileids.length>0),typeof actViewModel!="undefined"&&vmFile.idFileAssigned.assigntype===vmCommon.enumType.CrmStatusProtocol&&(n=actViewModel.get("activity"),typeof n!="undefined")){for(t=0;t<n.CrmStatusProtocolClients.length;t++)if(n.CrmStatusProtocolClients[t].Id===vmFile.idFileAssigned.assignidi){n.CrmStatusProtocolClients[t].StatusHasFileAssgined=vmFile.idFileAssigned.fileids.length>0?!0:!1;break}actViewModel.set("activity",n);kendo.bind($("#edit-form-activity"),actViewModel)}};vmFile.defaultFileAssigned=function(){vmFile.isChangeFileAssigned=!1;vmFile.tempAssignedFile={fileids:[],contents:[]}};vmFile.removeFileAssigned=function(n){if(vmFile.isChangeFileAssigned){var t=vmCommon.findIndexByFunc(vmFile.tempAssignedFile.fileids,function(t){return"cbx"+n===t});t!==-1&&(vmFile.tempAssignedFile.fileids.splice(t,1),vmFile.tempAssignedFile.contents.splice(t,1))}};vmFile.reloadPageFileIcon=function(){if(vmCommon.currentPageName==="CrmQuestionAnswer"){var n=new queryString(!0),t=n.get("fid"),i={fid:t},r="../Handlers/DFolderHandler.ashx?funcName=reloadfileiconthema&projid="+projectId+"&strid="+strategyId;callAjax("",r,JSON.stringify(i),function(n){vmFile.reloadThemaFileIcon(n.value)},AjaxConst.PostRequest)}return};vmFile.reloadThemaFileIcon=function(n){var t,i;if(n.length>0)for(t=0;t<n.length;t++)i=$("#spaniconfileAssigned"+n[t].Id),n[t].Status?i.hasClass("icon-folder-thema")&&i.removeClass("icon-folder-thema").addClass("icon-folder-thema-fileAssigned"):i.hasClass("icon-folder-thema-fileAssigned")&&i.removeClass("icon-folder-thema-fileAssigned").addClass("icon-folder-thema")};vmFile.generateFilesToString=function(n){for(var i="",r=n.length,t=0;t<r;t++){if(i+=n[t].name,t===r-1)break;i+=", "}return i};vmFile.checkEnableDeleteFileMarketing=function(n,t){var i=isNaN(n)?{assignidu:n,type:t}:{assignidi:n,type:t};return vmFile.dataservice.checkEnableDeleteFileMarketing(i)};vmFile.deleteMultiFileMarketing=function(n){return n.CanDelete&&n.Data.length>0?pConfirmReturnValue(kLg.confirmDeleteFileAssign).then(function(t){var r,i,u;if(t){for(r=[],i=0;i<n.Data.length;i++)u=n.Data[i],r.push({id:u.Id,Mdf:u.Mdf});return vmFile.dataservice.deleteMultiFileMarketing(r)}return Promise.resolve(!1)}):Promise.resolve(!1)}